(function(e){var d,f=e();e.fn.sortable=function(b){var a=String(b);return b=e.extend({connectWith:!1},b),this.each(function(){if(/^enable|disable|destroy$/.test(a)){var l=e(this).children(e(this).data("items")).attr("draggable",a=="enable");a=="destroy"&&l.add(this).removeData("connectWith items").off("dragstart.h5s dragend.h5s selectstart.h5s dragover.h5s dragenter.h5s drop.h5s");return}var k,j,l=e(this).children(b.items),c=e("<"+(/^ul|ol$/i.test(this.tagName)?"li":"div")+' class="sortable-placeholder">');l.find(b.handle).mousedown(function(){k=!0}).mouseup(function(){k=!1}),e(this).data("items",b.items),f=f.add(c),b.connectWith&&e(b.connectWith).add(this).data("connectWith",b.connectWith),l.attr("draggable","true").on("dragstart.h5s",function(h){if(b.handle&&!k){return !1}k=!1;var g=h.originalEvent.dataTransfer;g.effectAllowed="move",g.setData("Text","dummy"),j=(d=e(this)).addClass("sortable-dragging").index()}).on("dragend.h5s",function(){d.removeClass("sortable-dragging").show(),f.detach(),j!=d.index()&&l.parent().trigger("sortupdate",{item:d}),d=null}).not("a[href], img").on("selectstart.h5s",function(){return this.dragDrop&&this.dragDrop(),!1}).end().add([this,c]).on("dragover.h5s dragenter.h5s drop.h5s",function(g){return !l.is(d)&&b.connectWith!==e(d).parent().data("connectWith")?!0:g.type=="drop"?(g.stopPropagation(),f.filter(":visible").after(d),!1):(g.preventDefault(),g.originalEvent.dataTransfer.dropEffect="move",l.is(this)?(b.forcePlaceholderSize&&c.height(d.outerHeight()),d.hide(),e(this)[c.index()<e(this).index()?"after":"before"](c),f.not(c).detach()):!f.is(this)&&!e(this).children(b.items).length&&(f.detach(),e(this).append(c)),!1)})})}})(jQuery);